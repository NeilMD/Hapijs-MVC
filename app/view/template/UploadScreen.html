<!DOCTYPE HTML>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Upload Exercise - Elixir</title>
		<!-- Smart Wizard CCS Files -->

		<link href="css/smart_wizard.css" rel="stylesheet" type="text/css" /> 
		<link href="css/smart_wizard_theme_arrows.css" rel="stylesheet" type="text/css" />
		
		<!-- Chosen CSS Files -->
		<link rel="stylesheet" href="css/chosen.min.css" />
		
		<!-- Tag Manager CSS Files -->
		<link rel="stylesheet" href="css/tagmanager.css" />
		
		<!-- CSS Layout Files -->
		<link href="css/bootstrap.min.css" rel="stylesheet" />
		<link href="css/style.css" rel="stylesheet" />
		<link href="css/default.css" rel="stylesheet" />
		<link href="css/elixir-style.css" rel="stylesheet" />


		<script src='https://cloud.tinymce.com/stable/tinymce.min.js'></script>

	<body>
		<div id="wrapper">
			<!-- Navigation bar -->
			{%block header%}
			{%endblock%}
			<!-- End of navigation bar -->
						
			<!-- Banner -->
			<section class="callaction">
				<div class="container">
					<div class="row">
						<div class="col-lg-12">
							<div class="cta-text">
								<img id="banner" src="img/banner.png"> </img>
								<h1>UPLOAD EXERCISE</h1>
								<!-- Divider -->
								<div class="solidline"></div>
								<!-- End of divider -->
							</div>
						</div>
					</div>
				</div>
			</section>
			<!-- End of banner -->
			{%block container%}
			{%endblock%}
			
			
			<!-- Footer -->
			<footer>
				<div id="sub-footer">
					<div class="container">
						<div class="row">
							<div class="col-lg-6">
								<div class="copyright">
									<p>&copy; 2017 Project Elixir. All right reserved.</p>
								</div>
							</div>
							<div class="col-lg-6">
							</div>
						</div>
					</div>
				</div>
			</footer>
			<!-- End of footer -->
		</div>


		<!-- javascript
		================================================== -->
		<!-- Placed at the end of the document so the pages load faster -->
		<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>


		<script src="angular.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-tinymce/0.0.18/tinymce.js"></script>
		<script src="js/tinymce.js"></script>
		<script src="js/angular-sanitize.min.js"></script>


		<script src="js/jquery.easing.1.3.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<!-- Include external JS libs. -->

		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/mode/xml/xml.min.js"></script>
		<!-- Wizard -->	
		<script type="text/javascript" src="js/jquery.smartWizard.min.js"></script>
		<script src="js/chosen.jquery.min.js"></script>
		<!-- <script src="js/selectize.js"></script> -->

		<!-- Include Editor JS files. -->
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/froala-editor/2.5.1//js/froala_editor.pkgd.min.js"></script>
	

		
		
		
		
		
		
		
		
		<script src="js/tagmanager.js"></script>
		<script src='https://cloud.tinymce.com/stable/tinymce.min.js'></script>
		<!-- Scripts -->
			<script>


			$(document).ready(function(){
				var content,instruction, answer;
				var sw = $('#smartwizard').smartWizard({
					transitionEffect: 'fade', // Effect on navigation, none/slide/fade
					transitionSpeed: '400',
					
				});
				$(".sw-btn-next").click(function(){
					if($(this).html() == "Finish" && $(this).hasClass("last")){
						var title = $("#exercise-title").val();
						var area = $("#subject-select").val();
						var tags = $("input[type='hidden']").val().split(",");
						var ins = $("#ins").html();
						var ans = $("#answ").html();
						var ques = $("#ques").html();
						$.ajax({
							type:'POST',
							url:'/getData',
							data:{title:title, area:area, tags:tags,ins:ins,ans:ans,ques:ques },
							success:function(success){
								console.log("success");
							}
						});
						console.log(tags);
						console.log("SEE");
					}
				});
				$("#smartwizard").on("showStep", function(e, anchorObject, stepNumber, stepDirection) {
					console.log(stepNumber);

			         if(stepNumber == 3){
			         	// console.log(tinymce.get(ans).getContent());
			         	console.log($("input[type='hidden']").val());
			         	$(".sw-btn-next").html("Finish");			         	
			         	$(".sw-btn-next").removeClass("disabled").addClass("last");

			         }
			    });
		          $("#smartwizard").on("leaveStep", function(e, anchorObject, stepNumber, stepDirection) {
			         if(stepNumber == 3){
			         	$(".sw-btn-next").html("Next");			         	
			         	$(".sw-btn-next").removeClass("last");	
			         }
			      });

				var ans  = tinymce.init({
					selector: 'textarea#answerkey',
					height: $("#answerkeyexercise").height(),
					menubar: false,
					 
					style_formats: [
						{title: 'Heading', format: 'h3', classes: 'elixir-heading'},
						{title: 'Content', format: 'p', classes: 'elixir-content'}
					],
					toolbar: 'undo redo | styleselect | bold italic underline',
					content_css: 'css/tinymce.css'
				});
				var ins = tinymce.init({
					selector: 'textarea#instructions',
					height: 30,
					menubar: false,
					 
					style_formats: [
						{title: 'Content', format: 'p', classes: 'elixir-content'}
					],
					toolbar: 'undo redo | styleselect | bold italic underline',
					content_css: 'css/tinymce.css'
				});
				var con = tinymce.init({
					selector: 'textarea#content',
					height: 450,
					menubar: false,
					 
					style_formats: [
						{title: 'Heading', format: 'h3', classes: 'elixir-heading'},
						{title: 'Content', format: 'p', classes: 'elixir-content'}
					],
					toolbar: 'undo redo | styleselect | bold italic underline',
					content_css: 'css/tinymce.css'
				});
				$("#finish").addClass("disabled");
			
			  	$("select#subject-select").chosen({
					width: "100%"
				});
				$(".tm-input").tagsManager();
				// 	$(".tm-input").selectize({
				//     delimiter: ',',
				//     persist: false,
				//     create: function(input) {
				//         return {
				//             value: input,
				//             text: input
				//         }
				//     }
				// });
			});
		</script>
		
		<script>
		var app = angular.module('test',['ui.tinymce']);
		
		app.controller('myCtr', ['$scope','$sce',function($scope,$sce) {
		  $scope.tinymceOptions = {
		    onChange: function(e) {
		    	
		    },

		    inline: false,
		    plugins : 'advlist autolink link image lists charmap print preview',
		    skin: 'lightgray',
		    theme : 'modern',
		    height: 30,
			menubar: false,
			plugins: [
			],
			style_formats: [
				{title: 'Content', format: 'p', classes: 'elixir-content'}
			],
			toolbar: 'undo redo | styleselect | bold italic underline',
			content_css: 'css/tinymce.css',
		  	init_instance_callback:function(editor){
		  		editor.on('drop',function(){
		    		editor.focus();
		    	});
		  		$("button.sw-btn-next").click(function(){
		        	$(this).blur();
		     	});

		  		
		  	}
	        

		  };
		  $scope.tinymceOptions1 = {
		    onChange: function(e) {
		      // put logic here for keypress and cut/paste changes
		      	console.log(e.getContent());
		      
		    },

			height: 450,
			menubar: false,
			plugins: [
			],
			style_formats: [
				{title: 'Heading', format: 'h3', classes: 'elixir-heading'},
				{title: 'Content', format: 'p', classes: 'elixir-content'}
			],
			toolbar: 'undo redo | styleselect | bold italic underline',
			content_css: 'css/tinymce.css',
		    inline: false,
		    plugins : 'advlist autolink link image lists charmap print preview',
		    skin: 'lightgray',
		    theme : 'modern',
		    init_instance_callback:function(editor){
		    	editor.on('drop',function(){
		    		editor.focus();
		    	});
		    	$("button.sw-btn-next").click(function(){
		        	$(this).blur();
		     	});
		    	
		  		
		  	}
		  };
		  $scope.tinymceOptions2 = {
		    onChange: function(e) {
		      // put logic here for keypress and cut/paste changes
		      	console.log(e);
		       // $('#ans').html(e.getContent());
		       // return $scope.answa($sce.trustAsHtml(e.getContent));
		    },
		    inline: false,
		    height: $("#quest").height(),
			menubar: false,
			plugins: [
			],
			style_formats: [
				{title: 'Heading', format: 'h3', classes: 'elixir-heading'},
				{title: 'Content', format: 'p', classes: 'elixir-content'}
			],
			toolbar: 'undo redo | styleselect | bold italic underline',
			content_css: 'css/tinymce.css',
		    plugins : 'advlist autolink link image lists charmap print preview',
		    skin: 'lightgray',
		    theme : 'modern',
		    init_instance_callback:function(editor){
		    	editor.on('drop',function(e){
		    		editor.focus();
		    	});
		    	$("button.sw-btn-next").click(function(){
		    		// var s = "<script>m,mn,mn<"+'/' +"script>";
		      //   	$(this).html(s);
		     	});
		    	console.log("init");
		  		
		  		// $("#submitButton").click(function(){
		    //     	console.log( editor.getContent());	
		    //     });
		  		$("#submitButton").click(function(){
		  			// console.log("pumasok");
		  			// var html = $.parseHTML(editor.getContent());
		  			// var len = $(html).find("img").length;
		  			// $(html).nextAll("img").attr('src',"img.png");
		  			// console.log(html);
		  		
		        	$.ajax({
		        		type:'POST',
		        		url:'/getData',
		        		data:{'data':editor.getContent()},
		        		success:function(data){
		        			console.log('Success!');
		        		}
		        	})
		        });
		        
		  	},

		  	
		  };
		}]);
		angular.module('test')
	    .filter('qf', ['$sce', function($sce){
	        return function(text) {
	            return $sce.trustAsHtml(text);
	        };
	    }]);

		// var ins = tinymce.init({
		// 	selector: '#instructionBody',
		// 	menubar: 'file edit format',
		// 	 init_instance_callback: function (editor) {
		// 	    editor.on('change', function (e) {
		// 	     console.log("assd");
		// 	      // $('#ins').html(editor.getContent());
			      
		// 	    });
		// 	  }
		// });


		// var ques = tinymce.init({
		// 	selector: '#questionBody',
		// 	menubar: 'file edit format',
		// 	 init_instance_callback: function (editor) {
		// 	    editor.on('change', function (e) {
		// 	      console.log("asdd");
		// 	      // $('#quest').html(editor.getContent());
		// 	      // $('#ques').html(editor.getContent());
		// 	    });
		// 	  }
		// });

		// var ans = tinymce.init({
		// 	selector: '#answerBody',
		// 	menubar: 'file edit format',
		// 	 init_instance_callback: function (editor) {
		// 	    editor.on('change', function (e) {
		// 	   	  console.log("asd");
		// 	      // $('#answ').html(editor.getContent());
			      
		// 	    });
		// 	  }
		// });


	



	</script>

	</body>
</html>